(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[797],{9411:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/stake",function(){return r(84580)}])},48418:function(e,t,r){"use strict";function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(n=(c=i.next()).done)&&(r.push(c.value),!t||r.length!==t);n=!0);}catch(l){a=!0,o=l}finally{try{n||null==i.return||i.return()}finally{if(a)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}t.default=void 0;var a,o=(a=r(67294))&&a.__esModule?a:{default:a},c=r(76273),i=r(90387),l=r(57190);var s={};function u(e,t,r,n){if(e&&c.isLocalURL(t)){e.prefetch(t,r,n).catch((function(e){0}));var a=n&&"undefined"!==typeof n.locale?n.locale:e&&e.locale;s[t+"%"+r+(a?"%"+a:"")]=!0}}var f=function(e){var t,r=!1!==e.prefetch,a=i.useRouter(),f=o.default.useMemo((function(){var t=n(c.resolveHref(a,e.href,!0),2),r=t[0],o=t[1];return{href:r,as:e.as?c.resolveHref(a,e.as):o||r}}),[a,e.href,e.as]),d=f.href,p=f.as,h=e.children,x=e.replace,v=e.shallow,m=e.scroll,b=e.locale;"string"===typeof h&&(h=o.default.createElement("a",null,h));var y=(t=o.default.Children.only(h))&&"object"===typeof t&&t.ref,g=n(l.useIntersection({rootMargin:"200px"}),2),w=g[0],k=g[1],j=o.default.useCallback((function(e){w(e),y&&("function"===typeof y?y(e):"object"===typeof y&&(y.current=e))}),[y,w]);o.default.useEffect((function(){var e=k&&r&&c.isLocalURL(d),t="undefined"!==typeof b?b:a&&a.locale,n=s[d+"%"+p+(t?"%"+t:"")];e&&!n&&u(a,d,p,{locale:t})}),[p,d,k,b,r,a]);var N={ref:j,onClick:function(e){t.props&&"function"===typeof t.props.onClick&&t.props.onClick(e),e.defaultPrevented||function(e,t,r,n,a,o,i,l){("A"!==e.currentTarget.nodeName||!function(e){var t=e.currentTarget.target;return t&&"_self"!==t||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||e.nativeEvent&&2===e.nativeEvent.which}(e)&&c.isLocalURL(r))&&(e.preventDefault(),null==i&&n.indexOf("#")>=0&&(i=!1),t[a?"replace":"push"](r,n,{shallow:o,locale:l,scroll:i}))}(e,a,d,p,x,v,m,b)},onMouseEnter:function(e){c.isLocalURL(d)&&(t.props&&"function"===typeof t.props.onMouseEnter&&t.props.onMouseEnter(e),u(a,d,p,{priority:!0}))}};if(e.passHref||"a"===t.type&&!("href"in t.props)){var C="undefined"!==typeof b?b:a&&a.locale,E=a&&a.isLocaleDomain&&c.getDomainLocale(p,C,a&&a.locales,a&&a.domainLocales);N.href=E||c.addBasePath(c.addLocale(p,C,a&&a.defaultLocale))}return o.default.cloneElement(t,N)};t.default=f},57190:function(e,t,r){"use strict";function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(n=(c=i.next()).done)&&(r.push(c.value),!t||r.length!==t);n=!0);}catch(l){a=!0,o=l}finally{try{n||null==i.return||i.return()}finally{if(a)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}Object.defineProperty(t,"__esModule",{value:!0}),t.useIntersection=function(e){var t=e.rootMargin,r=e.disabled||!c,l=a.useRef(),s=n(a.useState(!1),2),u=s[0],f=s[1],d=a.useCallback((function(e){l.current&&(l.current(),l.current=void 0),r||u||e&&e.tagName&&(l.current=function(e,t,r){var n=function(e){var t=e.rootMargin||"",r=i.get(t);if(r)return r;var n=new Map,a=new IntersectionObserver((function(e){e.forEach((function(e){var t=n.get(e.target),r=e.isIntersecting||e.intersectionRatio>0;t&&r&&t(r)}))}),e);return i.set(t,r={id:t,observer:a,elements:n}),r}(r),a=n.id,o=n.observer,c=n.elements;return c.set(e,t),o.observe(e),function(){c.delete(e),o.unobserve(e),0===c.size&&(o.disconnect(),i.delete(a))}}(e,(function(e){return e&&f(e)}),{rootMargin:t}))}),[r,t,u]);return a.useEffect((function(){if(!c&&!u){var e=o.requestIdleCallback((function(){return f(!0)}));return function(){return o.cancelIdleCallback(e)}}}),[u]),[d,u]};var a=r(67294),o=r(9311),c="undefined"!==typeof IntersectionObserver;var i=new Map},84580:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return E}});var n=r(85893),a=r(41664),o=r(11163),c=r(6151),i=r(55480),l=r(61127),s=r(28520),u=r.n(s),f=(r(34155),r(67294)),d=r(66010),p=r(21092),h=r(98589),x=r(26778),v=r(18256),m=r(47915),b=r(40108),y=r.n(b),g=r(28437),w=r(7868);function k(e,t,r,n,a,o,c){try{var i=e[o](c),l=i.value}catch(s){return void r(s)}i.done?t(l):Promise.resolve(l).then(n,a)}function j(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function c(e){k(o,n,a,c,i,"next",e)}function i(e){k(o,n,a,c,i,"throw",e)}c(void 0)}))}}function N(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var C=function(e){var t=function(){return a()>0&&_},r=function(e){if(e.selected)return delete e.selected,void E(N(C));e.selected=1,E(N(C))},a=function(){return C.filter((function(e){return e.selected})).length},o=(0,p.useWeb3Context)(),c=Number("1"),i="0x9fdb31F8CE3cB8400C7cCb2299492F2A498330a4",l="0xb68B5cEdeFC2668a04D46926fD94fDae9fc143CC",s="0.005",b="10",k=(0,f.useState)([]),C=k[0],E=k[1],I=(0,f.useState)(!1),A=I[0],M=I[1],S=(0,f.useState)(!1),_=S[0],P=S[1],L=(0,f.useState)(null),B=L[0],R=L[1],O=(0,f.useState)("0.003"),T=O[0],F=O[1],H=(0,f.useState)(!1),D=H[0],W=H[1];function U(){return Z.apply(this,arguments)}function Z(){return(Z=j(u().mark((function e(){var t,r,n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new o.library.eth.Contract(h.Mt,l),e.next=3,t.methods.minimumFlashFee(i).call();case 3:r=e.sent,n=o.library.utils.fromWei(r,"ether"),console.log(n),F(n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function K(){return q.apply(this,arguments)}function q(){return(q=j(u().mark((function e(){var t,r,n,a,c,f,d,p;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],r=new o.library.eth.Contract(h.Mt,l),e.next=4,r.methods.getOwnedERC721ByAddress(i,o.account).call();case 4:if(n=e.sent,a=n.length){e.next=9;break}return M(!0),e.abrupt("return");case 9:c=0;case 10:if(!(c<a)){e.next=20;break}return f=n[c],e.next=14,(0,v.Xv)(n[c],o);case 14:d=e.sent,p=s,t.push({rentalCost:p,tokenId:f,color:d});case 17:++c,e.next=10;break;case 20:E(t),M(!0);case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function X(){return(X=j(u().mark((function e(){var t,r,n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return W("approving"),t=new o.library.eth.Contract(x.Mt,i),r=t.methods.setApprovalForAll(l,!0),e.next=5,(0,m.p)(o.library,{data:r.encodeABI(),to:i,cost:"0",from:B,count:1});case 5:return n=e.sent,console.log(n),(null===n||void 0===n?void 0:n.transactionHash)&&P(!0),W(void 0),e.abrupt("return");case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function z(){return(z=j(u().mark((function e(){var n,a,c,s,f,p;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t()){e.next=2;break}return e.abrupt("return");case 2:if((n=C.filter((function(e){return e.selected})).map((function(e){return parseInt(e.tokenId)}))).length){e.next=5;break}return e.abrupt("return",d.ZP.error("No colors selected"));case 5:return W(!0),a=new o.library.eth.Contract(h.Mt,l),c=C.filter((function(e){return n.includes(parseInt(e.tokenId))})).map((function(e){return o.library.utils.toWei(e.rentalCost,"ether")})),console.log([n,c]),s=a.methods.addStaked(i,n,c),e.next=12,(0,m.p)(o.library,{data:s.encodeABI(),to:l,cost:"0",from:B,count:1});case 12:if(f=e.sent,W(!1),null===f||void 0===f?void 0:f.transactionHash){e.next=16;break}return e.abrupt("return");case 16:return p=C.filter((function(e){return!n.includes(parseInt(e.tokenId))})).map((function(e){return n.includes(parseInt(e.tokenId))&&r(e),e})),E(p),e.abrupt("return");case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}if((0,f.useEffect)(j(u().mark((function e(){var t,r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o.active||o.networkId!==c){e.next=12;break}return R(o.account),e.next=4,U();case 4:return e.next=6,K();case 6:return t=new o.library.eth.Contract(x.Mt,i),e.next=9,t.methods.isApprovedForAll(o.account,l).call();case 9:r=e.sent,console.log("is approved ".concat(r)),P(r);case 12:case"end":return e.stop()}}),e)}))),[o]),o.active){if(o.networkId!==c)return(0,n.jsx)("div",{className:"flex-1 font-bold text-red flex text-center center-content justify-center",children:(0,n.jsx)("p",{className:"font-bold title-font uppercase text-4xl",children:"Please switch network to Ethereum mainnet"})});if(o.account)return(0,n.jsxs)("div",{className:"w-full mx-auto lg:w-2/3 rounded py-10 px-6 lg:px-0",children:[(0,n.jsxs)("div",{className:"mb-10 ",children:[(0,n.jsx)("p",{className:"text-center mb-1 text-xl font-bold title-font sm:text-4xl text-3xl mb-2 font-black text-gray-900 pt-0 mt-0 uppercase",children:"Select Colors to Stake"}),(0,n.jsx)("p",{className:"text-black text-center mb-10 font-late-500 text-md",children:"enter desired rental fee per lend under token"}),(0,n.jsxs)("div",{className:"flex flex-wrap colors justify-center content-center",children:[A&&C&&C.map((function(e){return(0,n.jsxs)("div",{className:"mx-4",children:[(0,n.jsx)("div",{onClick:function(){return r(e)},className:"border-solid border-4 border-gray-800 opacity-85  color shadow-lg "+(1==e.selected?"".concat(y().colorActive," ring-4 ring-offset-0 ring-blue-700"):"border-white"),style:{width:75,height:75,background:e.color,cursor:"pointer",margin:10}}),(0,n.jsxs)("label",{className:"justify-center rounded flex text-center center-text border-2 border-slate-200 ",children:[e.fee," ",(0,n.jsx)("input",{onChange:function(t){!function(e,t){e.rentalCost=t,E(N(C))}(e,t.target.value)},onBlur:function(t){!function(e,t){if(isNaN(Number(t)))return e.rentalCost=s,E(N(C)),d.ZP.error("Valid rental fee required");if(/\.\d\d\d\d\d/.test(t))return e.rentalCost=s,E(N(C)),d.ZP.error("Max precision reached");var r=o.library.utils.toBN(o.library.utils.toWei(t,"ether")),n=o.library.utils.toBN(o.library.utils.toWei(T,"ether")),a=o.library.utils.toBN(o.library.utils.toWei(b,"ether"));r.lt(n)?(e.rentalCost=s,E(N(C)),d.ZP.error("Minimum rental fee is 0.003 ETH")):r.gt(a)&&(e.rentalCost=s,E(N(C)),d.ZP.error("Maximum rental fee is 10 ETH"))}(e,t.target.value)},type:"text",style:{width:"65px"},className:"inline-block py-1 pl-2 appearance-none text-black  ",value:e.rentalCost}),(0,n.jsx)("span",{style:{top:"7px"},className:"relative inline-block",children:(0,n.jsx)(g.k,{width:10})})]})]},e.color)})),!A&&(0,n.jsx)(w.a,{}),A&&!C.length&&(0,n.jsx)("div",{children:(0,n.jsx)("p",{className:"text-red-500 uppercase font-bold",children:"No colors available to stake"})})]})]}),_&&C&&C.length>0&&(0,n.jsx)("div",{className:"content-center justify-center flex mb-10",children:(0,n.jsx)("button",{onClick:D?function(){}:function(){return z.apply(this,arguments)},className:"mx-5 hover:bg-green-700 text-white font-bold py-2 px-4 rounded bg-blue-700 ".concat(t()||D?"":"opacity-50"),children:D?"Staking...":"Stake Colors"})}),!_&&C&&C.length>0&&(0,n.jsx)("div",{className:"content-center justify-center flex mb-10",children:(0,n.jsx)("button",{onClick:D?function(){}:function(){return X.apply(this,arguments)},className:"bg-blue-700 mx-5 hover:bg-green-700 text-white font-bold py-2 px-4 rounded",children:D?"Approving...":"Approve All Colors"})})]})}return(0,n.jsx)("div",{className:"flex-1 flex center-content justify-center",children:(0,n.jsx)("p",{className:"font-bold title-font uppercase text-4xl",children:"Please Connect via MetaMask"})})};function E(){(0,o.useRouter)().query;return(0,n.jsx)("div",{className:"relative",children:(0,n.jsxs)("div",{className:y().mainContainer,children:[(0,n.jsx)(i.w,{}),(0,n.jsx)(l.w,{}),(0,n.jsxs)("div",{className:y().container,children:[(0,n.jsx)("div",{className:y().main,children:(0,n.jsxs)("main",{className:"relative container mx-auto  ",children:[(0,n.jsx)("div",{className:"text-left align-left ",children:(0,n.jsxs)("nav",{className:"border-gray-800 border-b-0 justify-start flex flex-row",children:[(0,n.jsx)(a.default,{prefetch:!1,href:"/stake",children:(0,n.jsx)("button",{className:"".concat(y().menuItem," ").concat(y().menuActive),children:"Stake Colors"})}),(0,n.jsx)(a.default,{prefetch:!1,href:"/balances",children:(0,n.jsx)("button",{className:"".concat(y().menuItem),children:"Unstake & Claim Royalties"})})]})}),(0,n.jsx)("div",{className:"bg-white  border-gray-800 border-8 relative container mx-auto flex px-5 py-6 lg:py-24 md:flex-row flex-col items-center",children:(0,n.jsx)(C,{})})]})}),(0,n.jsx)(c.$,{})]})]})})}},9008:function(e,t,r){e.exports=r(5443)},41664:function(e,t,r){e.exports=r(48418)},11163:function(e,t,r){e.exports=r(90387)}},function(e){e.O(0,[47,775,774,888,179],(function(){return t=9411,e(e.s=t);var t}));var t=e.O();_N_E=t}]);